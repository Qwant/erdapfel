{{
    let isAnywherePoi = false;
    if(this && this.poi && this.poi.id.match(/latlon:/)){
        isAnywherePoi = true;
    }
}}
{{? this.poi && this.active }}
  <div class="poi_panel__header
    {{= this.card ? ' poi_header_card' : '' }}
    {{= this.fromFavorite || this.fromCategory ? ' poi_header_back_to_list' : '' }}
  ">
    {{? this.fromFavorite }}
      <div class="poi_panel__back_to_list" {{= click(this.backToFavorite, this) }}>
        <i class="poi_panel__back icon-arrow-left"></i>
        <span class="poi_panel__back_text">{{= _('Back to favorite') }}</span>
        {{? this.poi.isFromPagesjaunes && this.poi.isFromPagesjaunes() }}
        <img class="poi_panel__back_to_list_logo" src="./statics/images/pagesjaunes.svg" alt="PagesJaunes" />
        {{?}}
      </div>
    {{?? this.fromCategory }}
      <div class="poi_panel__back_to_list" {{= click(this.backToList, this) }}>
        <i class="poi_panel__back icon-arrow-left"></i>
        <span class="poi_panel__back_text">{{= _('Back to list') }}</span>
        {{? this.poi.isFromPagesjaunes && this.poi.isFromPagesjaunes() }}
        <img class="poi_panel__back_to_list_logo" src="./statics/images/pagesjaunes.svg" alt="PagesJaunes" />
        {{?}}
      </div>
    {{?? !this.card }}
      <div class="poi_panel__back_mobile" {{= click(this.backToSmall, this) }}>
        <i class="poi_panel__back icon-arrow-left"></i>
        <span class="poi_panel__back_text">{{= _('Back') }}</span>
        {{? this.poi.isFromPagesjaunes && this.poi.isFromPagesjaunes() }}
          <img class="poi_panel__back_to_list_logo" src="./statics/images/pagesjaunes.svg" alt="PagesJaunes" />
        {{?}}
      </div>
    {{??}}
      {{? this.poi.isFromPagesjaunes && this.poi.isFromPagesjaunes() }}
        <div class="poi_panel__pj_logo_container">
          <img class="poi_panel__back_to_list_logo" src="./statics/images/pagesjaunes.svg" alt="PagesJaunes" />
        </div>
      {{?}}
    {{?}}

    <div class="poi_panel__close" {{= click(this.closeAction, this) }}>
      <i class="icon-x"></i>
    </div>

  </div>
{{?}}
<div class="poi_panel{{= this.active ? '' : ' poi_panel--hidden' }}{{= this.card ? ' poi_panel--card ' : '' }}">
  {{? this.poi }}
    <div class="poi_panel__content__card">
      {{? this.fromCategory }}
      <div class="poi_panel__close" {{= this.fromCategory ? click(this.backToList, this) : click(this.closeAction, this) }}>
        <i class="icon-x"></i>
      </div>
      {{?}}
      <div class="poi_panel__content__card__content">
       {{= this.panel.renderPartial(this.headerPartial) }}
       {{= this.minimalHourPanel.render() }}
      </div>
      <div class="poi_panel__content__card__action__container">
        {{? this.isDirectionActive }}
          <button class="poi_panel__content__card__action poi_panel__content__card__action__direction" {{= click(this.openDirection, this) }}>
            <span class="icon-corner-up-right"></span>
            {{= _('DIRECTIONS', 'poi panel') }}
          </button>
        {{?}}
        <button class="poi_panel__content__card__action" {{= click(this.showDetail, this) }}>
          <span class="icon-chevrons-right"></span>
          {{= _('SEE MORE', 'poi panel') }}
        </button>
      </div>
    </div>
  {{?}}
  <div class="poi_panel__content">
  {{? this.poi }}
    <div class="poi_panel__container">
      <div class="poi_panel__description_container" {{= click(this.center, this) }}>
         {{= this.panel.renderPartial(this.headerPartial) }}
      </div>
      <div class="poi_panel__actions">
        <div class="button_container" {{= click(this.toggleStorePoi, this) }}>
          {{? this.poi.stored}}
            <button class="poi_panel__actions__icon__store poi_panel__actions__icon icon-icon_star-filled"></button>
            <div class="poi_panel__actions__text">{{= _('SAVED', 'poi') }}</div>
          {{??}}
            <button class="poi_panel__actions__icon__store poi_panel__actions__icon icon-icon_star"></button>
            <div class="poi_panel__actions__text">{{= _('FAVORITES', 'poi') }}</div>
          {{?}}
        </div>
        <div class="poi_panel__actions__share_container button_container" {{= click(this.openShare, this) }}>
          <button class="poi_panel__actions__icon icon-share-2">
          </button>
          <div class="poi_panel__actions__text">{{= _('SHARE', 'poi') }}</div>
        </div>
        {{? this.isDirectionActive }}
          <div class="poi_panel__actions__direction_container button_container" {{= click(this.openDirection, this) }}>
            <button class="poi_panel__actions__icon icon-corner-up-right">
            </button>
            <div class="poi_panel__actions__text">{{= _('DIRECTIONS', 'poi') }}</div>
          </div>
        {{?}}
        {{? this.poi.blocksByType.phone}}
          {{? this.shouldPhoneBeHidden() }}
          <a class="poi_panel__actions__phone_container button_container poi_phone_container_hidden" {{= click(this.showPhone, this) }}>
            <button class="poi_panel__actions__icon icon-icon_phone"></button>
            <div class="poi_panel__actions__text">{{= _('SHOW NUMBER', 'poi') }}</div>
          </a>
          {{?}}
          <a {{? this.shouldPhoneBeHidden() }} style="display:none" {{?}}
            class="poi_panel__actions__phone_container button_container poi_phone_container_revealed" data-rel="external" rel="noopener noreferrer" href="{{= this.poi.blocksByType.phone.url }}">
            <button class="poi_panel__actions__icon icon-icon_phone"></button>
            <div class="poi_panel__actions__text">{{= this.htmlEncode(this.poi.blocksByType.phone.local_format) }}</div>
          </a>
        {{?}}
      </div>

      {{? isAnywherePoi && this.categories }}
          <div class="service_panel__categories--poi">
            <hr>
            <h3><span class="icon-icon_compass"></span> {{= _("Search around this place", "poi") }}</h3>
            {{~ this.categories:category:index }}
              {{?
                !this.mustDeployCategories ||
                (this.mustDeployCategories && !this.isDeployed && index + 1 < 8) ||
                (this.mustDeployCategories && this.isDeployed)
              }}
                <button class="service_panel__category" type="button" {{= click(this.openCategory, this, category) }}>
                  <div class="service_panel__category__icon" style="background: {{= category.backgroundColor }}">
                    <span class="icon icon-{{= category.iconName }}"></span>
                  </div>
                  <div class="service_panel__category__title">{{= category.label }}</div>
                </button>
            {{?}}
          {{~}}
          </div>
        {{?}}

      {{= this.PoiBlocContainer.render(this.poi) }}

      {{? isAnywherePoi || (this.poi.isFromOSM && this.poi.isFromOSM()) }}
      <div class="osm_contribute">
        <div class="osm_contribute__logo"></div>
        <div class="osm_contribute__text_container">
          <p class="osm_contribute__title">
            {{= _('Qwant Maps uses OpenStreetMap data.') }}
          </p>
          <a class="osm_contribute__link" href="{{= this.poi.viewUrl }}" rel="noopener noreferrer" target="_blank">
            <i class="icon-chevrons-right osm_contribute__icon"></i>
            <span class="osm_contribute__about">{{= _('VIEW') }}</span>
          </a>
          <a class="osm_contribute__link" href="{{= this.poi.editUrl }}" rel="noopener noreferrer" target="_blank">
            <i class="icon-chevrons-right osm_contribute__icon" style="margin-left: 10px;"></i>
            <span class="osm_contribute__about">{{= _('EDIT') }}</span>
          </a>
        </div>
      </div>
      {{?}}

    </div>
  {{?}}
  </div>
</div>
